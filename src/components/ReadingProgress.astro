---
---
<div id="reading-progress-container">
  <div id="reading-progress-bar"></div>
</div>

<style>
  #reading-progress-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    z-index: 9999;
    background: transparent;
  }

  #reading-progress-bar {
    width: 0%;
    height: 100%;
    background: linear-gradient(
      90deg,
      oklch(65% 0.18 var(--hue)),
      oklch(75% 0.22 var(--hue))
    );
    transition: width 0.1s linear;
  }
</style>

<script>
  function updateReadingProgress() {
    const scrollTop =
      document.documentElement.scrollTop || document.body.scrollTop;
    const scrollHeight =
      document.documentElement.scrollHeight -
      document.documentElement.clientHeight;

    if (scrollHeight <= 0) return;

    const progress = (scrollTop / scrollHeight) * 100;
    const bar = document.getElementById("reading-progress-bar");
    if (bar) {
      bar.style.width = progress + "%";
    }
  }

  window.addEventListener("scroll", updateReadingProgress, { passive: true });

  // Swup / Astro 換頁後重新計算
  document.addEventListener("swup:contentReplaced", () => {
    updateReadingProgress();
  });

  window.addEventListener("load", updateReadingProgress);
</script>
